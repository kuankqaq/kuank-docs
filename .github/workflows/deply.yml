name: Auto_Deploy_To_Baota
on:
  push:
    branches:
      - main  # 当你往 main 分支推代码时触发

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install MkDocs
        run: pip install mkdocs-material

      - name: Build
        run: mkdocs build

      - name: Sync to Baota
        uses: easingthemes/ssh-deploy@main
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
          REMOTE_HOST: ${{ secrets.SERVER_IP }}
          REMOTE_USER: root
          REMOTE_PORT: ${{ secrets.SSH_PORT }}  # <--- 关键修改：改为 REMOTE_PORT
          SOURCE: "site/"  # MkDocs 生成的目录
          TARGET: "/www/wwwroot/docs.kuank.top" # 宝塔站点的绝对路径
          ARGS: "-avz --delete" # 确保服务器文件与 GitHub 完全一致